
@{
    ViewBag.Title = "Enzyme";
    Layout = "~/Views/Shared/_Layout.cshtml";
    string Name = (string)ViewBag.Name;
    int plasmidId = (int)ViewBag.PlasmidId;
    string Sequence = (string)ViewBag.Sequence;
    int seqCount = (int)ViewBag.SeqLength;
    var features = ViewBag.Features;
    var methylation = ViewBag.Methylation;
    var enzymes = ViewBag.Enzymes;
    var Tag = (string)ViewBag.Tag;
}

<div class="row">
    <div class="col-sx-12 hidden-sm hidden-xs col-sm-12 col-md-3 col-lg-2">
        &nbsp;
    </div>
    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-8">
        <h3 class="text-warning text-center">
            Plasmid <em>@Name</em> Restriciton Digest&nbsp;
        </h3>
    </div>
    <div class="col-sx-12 col-sm-12 col-md-3 col-lg-2">
        <h3>
            <a id="autogenerate" class="btn btn-default" href="@Url.Action("Sequence", "Map", new { plasmid_id = plasmidId })">
                <i class="fa fa-exchange text-danger"></i>
                <span>Sequence</span>
            </a>
            <a id="autogenerate" class="btn btn-default" href="@Url.Action("Index", "Map", new { id = plasmidId, tag = Tag })">
                <i class="fa fa-bullseye text-danger"></i>
                <span>Plasmid Map</span>
            </a>
        </h3>
    </div>
</div>
<span id="decodeIt" class="hidden"></span>
<span id="sequence" class="hidden">@seqCount</span>
<span id="name" class="hidden">@Name</span>



<div class="row">
    <div class="col-xs-12 col-sm-12 col-md-8" id="giraffe-map">

    </div>
    <div class="col-xs-12 col-sm-12 col-md-4">

    </div>
</div>







@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/giraffe2")

<script>
    //get plasmid feature json data
    var features = ("@features");
    document.getElementById("decodeIt").innerHTML = features;
    features = document.getElementById("decodeIt").textContent;

    //get full sequence
    seqCount = document.getElementById("sequence").textContent;
    seqCount = parseInt(seqCount)
    //get plasmid name
    name = document.getElementById("name").textContent;

    try
    {
        features = JSON.parse(features);
        //console.log(features);
        data = [seqCount, features];
        //console.log(data);
        var gd = GiraffeDraw();
        gd.read(data);

        gd.LinearMap({
            'map_dom_id': 'giraffe-map',
            'plasmid_name': name,
            'map_width': 848
            //'map_height': 324  
        })
    }
    catch(e)
    {
        //alert(e);
    }
</script>